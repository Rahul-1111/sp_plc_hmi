<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP PLC HMI</title>
    <link href="{{ url_for('static', filename='css/roboto.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='js/socket.io.min.js') }}"></script>
    <style>
        html {
            height: 100%;
        }
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            padding-bottom: 80px;
            min-height: 100%;
        }
        h1, h2 {
            color: #333;
            font-size: 32px;
            margin-bottom: 5px;
            margin-top: -10px;
            text-align: center;
        }
        .group {
            background-color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .group h3 {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
            margin-bottom: 10px;
            margin-top: 0px;
            font-size: 20px;
            color: #444;
        }
        .indicator {
            display: inline-block;
            width: 35px;
            height: 30px;
            border-radius: 50%;
            margin-left: 5px;
            border: 1px solid #333;
        }
        .indicator-image {
            display: inline-block;
            width: 35px;
            height: 30px;
            margin-left: 5px;
            vertical-align: middle;
            object-fit: contain;
        }
        .indicator-image-large {
            width: 520px; /* Increased width for larger images */
            height: 390px; /* Set fixed height for consistency */
            border: 2px solid #333; /* Adjusted frame width */
            border-radius: 8px;
            display: block;
            margin: 0 auto;
        }
        .indicator-video-large {
            width: 1067px; /* Increased width for larger videos */
            height: 600px; /* Set fixed height for consistency */
            object-fit: contain; /* Ensure video scales properly */
            border: 2px solid #333; /* Adjusted frame width */
            border-radius: 8px;
            display: block;
            margin: 0 auto;
        }
        .on {
            background-color: #28a745;
        }
        .off {
            background-color: #dc3545;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            vertical-align: middle;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #dc3545;
            transition: 0.4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #28a745;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        button {
            margin: 2px;
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .control-button {
            margin: 2px;
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.2s;
            vertical-align: middle;
        }
        .control-button:hover {
            background-color: #0056b3;
        }
        .control-button:active {
            background-color: #0056b3;
            transform: scale(0.98);
        }
        .write-button {
            padding: 6px 12px;
            font-size: 14px;
            margin-left: 5px;
            vertical-align: middle;
        }
        input[type="number"] {
            margin-left: 5px;
            padding: 6px;
            width: 80px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
            vertical-align: middle;
        }
        input[type="number"].error {
            border-color: #dc3545;
            background-color: #ffe6e6;
        }
        select {
            padding: 6px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
            vertical-align: middle;
            margin-left: 5px;
        }
        table {
            width: 100%;
            max-width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 14px;
            background: linear-gradient(180deg, #ffffff, #f9f9f9);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-radius: 8px;
            table-layout: auto;
        }
        th, td {
            padding: 8px; /* Updated from 1px to 8px for better readability */
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
            white-space: nowrap;
            font-weight: bold;
        }
        th {
            background: linear-gradient(90deg, #007bff, #0056b3);
            color: white;
            font-size: 14px;
            text-transform: uppercase;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e9ecef;
            transition: background-color 0.2s;
        }
        .flex-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .flex-row .group {
            flex: 1;
            min-width: 300px;
            max-width: 48%;
            overflow-x: auto;
        }
        .page {
            display: none;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }
        .active {
            display: block;
        }
        .nav-bar {
            display: flex;
            justify-content: center;
            background-color: #007bff;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
        }
        .nav-button {
            margin: 0 10px;
            padding: 10px 10px;
            font-size: 20px;
            background-color: #ffffff;
            color: #007bff;
            border: 1px solid #007bff;
            border-radius: 4px;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .nav-button:hover {
            background-color: #0056b3;
            color: white;
        }
        .nav-button.alarm-active {
            color: #ffffff;
            border-color: #dc3545;
            background-color: #dc3545;
            animation: attractiveBlink 1.5s infinite ease-in-out;
        }
        @keyframes attractiveBlink {
            0% {
                background-color: #dc3545;
                box-shadow: 0 0 10px rgba(220, 53, 69, 0.8);
                transform: scale(1);
            }
            50% {
                background-color: #ff6200;
                box-shadow: 0 0 20px rgba(255, 98, 0, 0.9);
                transform: scale(1.05);
            }
            100% {
                background-color: #dc3545;
                box-shadow: 0 0 10px rgba(220, 53, 69, 0.8);
                transform: scale(1);
            }
        }
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .popup-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        .popup-content h3 {
            color: #dc3545;
            margin-bottom: 15px;
            text-align: center;
            font-size: 20px;
        }
        .popup-content ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .popup-content li {
            color: #dc3545;
            font-size: 18px;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            font-weight: bold;
        }
        .popup-content li:last-child {
            border-bottom: none;
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
        }
        .close-button:hover {
            background-color: #b02a37;
        }
        #set-quantity .table-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        #set-quantity .column {
            flex: 1;
            min-width: 300px;
            max-width: 50%;
            display: flex;
            flex-direction: column;
            gap: 0px;
        }
        #set-quantity .column .group {
            max-width: 100%;
            overflow-x: auto;
        }
        #set-quantity .vfd-table {
            overflow-x: auto;
        }
        #set-quantity .vfd-table table {
            min-width: 600px;
            table-layout: fixed;
        }
        #set-quantity .vfd-table th,
        #set-quantity .vfd-table td {
            width: 20%;
            min-width: 100px;
            white-space: normal;
            text-align: center;
            padding: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            border-right: 1px solid #e0e0e0;
        }
        #set-quantity .vfd-table th {
            font-size: 12px;
            line-height: 1.2;
        }
        #set-quantity th:nth-child(2),
        #set-quantity td:nth-child(2) {
            width: 40%;
            text-align: left;
        }
        #set-quantity th:nth-child(1),
        #set-quantity td:nth-child(1) {
            width: 10%;
        }
        #set-quantity th:nth-child(3),
        #set-quantity td:nth-child(3),
        #set-quantity th:nth-child(4),
        #set-quantity td:nth-child(4),
        #set-quantity th:nth-child(5),
        #set-quantity td:nth-child(5) {
            width: 15%;
        }
        #set-quantity .vfd-table th:nth-child(1),
        #set-quantity .vfd-table td:nth-child(1),
        #set-quantity .vfd-table th:nth-child(2),
        #set-quantity .vfd-table td:nth-child(2),
        #set-quantity .vfd-table th:nth-child(3),
        #set-quantity .vfd-table td:nth-child(3),
        #set-quantity .vfd-table th:nth-child(4),
        #set-quantity .vfd-table td:nth-child(4),
        #set-quantity .vfd-table th:nth-child(5),
        #set-quantity .vfd-table td:nth-child(5) {
            width: 20%;
            text-align: center;
        }
        .general-container {
            display: flex;
            flex-direction: row;
            gap: 20px;
            flex-wrap: wrap;
        }
        .general-read-values {
            flex: 0 0 35%;
            max-width: 35%;
            min-width: 300px;
        }
        .bin-visibility-group {
            flex: 1;
            min-width: 300px;
        }
        #bin-visibility-container {
            padding: 0px;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        #video-display {
            text-align: center;
        }
        .bin-images-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }
        #current-bin, #next-bin {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        #current-bin h4, #next-bin h4, #video-display h4 {
            margin: 0px 0;
            font-size: 18px;
            color: #007bff;
        }
        #current-bin p, #next-bin p, #video-display p {
            margin: 5px 0;
            font-size: 16px;
            font-weight: bold;
        }
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #007bff;
            color: white;
            padding: 10px 0;
            z-index: 1000;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
        }
        .footer-actions {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            padding: 5px 10px;
        }
        .footer-action {
            display: flex;
            align-items: center;
            gap: 5px;
            background-color: #ffffff;
            color: #007bff;
            border: 1px solid #007bff;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 14px;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .footer-action:hover {
            background-color: #0056b3;
            color: white;
        }
        .footer-action .toggle-switch {
            width: 50px;
            height: 28px;
        }
        .footer-action .slider {
            background-color: #dc3545;
        }
        .footer-action .slider:before {
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
        }
        .footer-action input:checked + .slider {
            background-color: #28a745;
        }
        .footer-action input:checked + .slider:before {
            transform: translateX(22px);
        }
        .footer-copyright {
            text-align: center;
            font-size: 14px;
            margin-top: 5px;
        }
        .status-button {
            margin: 0 10px;
            padding: 10px 20px;
            font-size: 20px;
            background-color: #ffffff;
            color: #333333;
            border: 2px solid #007bff;
            border-radius: 4px;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: left;
            min-width: 200px;
        }
        .status-button:hover {
            color: #ffffffff;
            border-color: #0056b3;
        }
        .status-button span {
            color: #22973c;
            font-size: 22px;
            font-weight: bolder;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .status-button select {
            background-color: #ffffff;
            color: #007bff;
            border: 1px solid #007bff;
            font-size: 18px;
            font-weight: bold;
            margin-left: 5px;
            padding: 4px 8px;
        }
        .status-button select option {
            background-color: #ffffff;
            color: #333333;
        }
        .plunger-count {
            background-color: #e8f5e8;
        }
        .ring-feeder-count {
            background-color: #fff3e0;
        }
        .arm-count {
            background-color: #e3f2fd;
        }
        .reset-counts-pressing {
            background-color: #ffcc00 !important;
            color: #333 !important;
            border-color: #ff9900 !important;
            animation: pulse 0.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        #success-msg {
            display: none;
            position: fixed;
            top: 60px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 25px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
            z-index: 3000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <h1>PRAGATI</h1>

    <div class="nav-bar">
        <button class="status-button">
            🔽 SELECT RECIPE: 
            <select id="D556_select" onchange="writeWord('D556', this.value)">
                <option value="0">👇 SELECT RECIPE</option>
                <option value="1">GRIPPER ARM CD200 - BT40 SERIES</option>
                <option value="2">GRIPPER ARM CD225 - BT40 SERIES</option>
                <option value="3">GRIPPER ARM CD250 - BT40 SERIES</option>
                <option value="4">GRIPPER ARM CD 275 - BT40 SERIES</option>
                <option value="5">GRIPPER ARM CD 300 - BT40 SERIES</option>
                <option value="6">GRIPPER ARM CD315 - BT40 SERIES</option>
                <option value="7">GRIPPER ARM-CD225-V2 SERIES</option>
                <option value="8">GRIPPER ARM-CD250-V2 SERIES</option>
                <option value="9">GRIPPER ARM-CD300-V2 SERIES</option>
                <option value="10">GRIPPER ARM-315-90-V2 SERIES</option>
            </select>
        </button>
        <button class="nav-button" onclick="showPage('home')">🤖 AUTO</button>
        <button class="nav-button" onclick="showPage('set-quantity')">⚙️ QUANTITY</button>
        <button class="nav-button" id="alarm-button" onclick="toggleAlarmPopup()">🚨 ALARMS</button>
        <button class="status-button">
            🗑️ BIN NO: <span id="D302">0</span>
        </button>
        <button class="status-button plunger-count">
            🔩 PLUNGER COUNT: <span id="D560">0</span>
        </button>
        <button class="status-button ring-feeder-count">
            ⭕ RING FEEDER COUNT: <span id="D562">0</span>
        </button>
        <button class="status-button arm-count">
            🦾 ARM COUNT: <span id="D564">0</span>
        </button>
        <button class="status-button" id="reset-counts-btn">🔄 RESET COUNTS</button>
        <button class="status-button" id="data-load-btn" onmousedown="setBit('M7', true)" onmouseup="setBit('M7', false); showSuccess();" ontouchstart="setBit('M7', true)" ontouchend="setBit('M7', false); showSuccess();">DATA LOAD</button>
    </div>

    <div id="success-msg">Data Loaded Successfully!</div>

    <div id="alarm-popup" class="popup">
        <div class="popup-content">
            <button class="close-button" onclick="toggleAlarmPopup()">Close</button>
            <h3>Active Alarms</h3>
            <ul id="alarm-list"></ul>
        </div>
    </div>

    <div id="home" class="page active">
        <div class="general-container">
            <div class="group general-read-values">
                <h3>Input</h3>
                <table>
                    <thead>
                        <tr>
                            <th>SR NO</th>
                            <th>Name</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>EMG STOP</td>
                            <td><span class="indicator off" id="indicator-M9"></span></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>PLUNGER ASSLY AUTO READY</td>
                            <td><span class="indicator off" id="indicator-M300"></span></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>RING FEEDER ASSLY AUTO READY</td>
                            <td><span class="indicator off" id="indicator-M400"></span></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>ARM ASSLY AUTO READY</td>
                            <td><span class="indicator off" id="indicator-M500"></span></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>PLUNGER ASSLY AUTO ON</td>
                            <td><span class="indicator off" id="indicator-M301"></span></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>RING FEEDER ASSLY AUTO ON</td>
                            <td><span class="indicator off" id="indicator-M401"></span></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>ARM ASSLY AUTO ON</td>
                            <td><span class="indicator off" id="indicator-M501"></span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Output</h3>
                <table>
                    <thead>
                        <tr>
                            <th>SR NO</th>
                            <th>Name</th>
                            <th>Control</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>INDEXER MOTOR HOME</td>
                            <td><button class="control-button" onmousedown="setBit('M3', true)" onmouseup="setBit('M3', false)" ontouchstart="setBit('M3', true)" ontouchend="setBit('M3', false)">HOME</button></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>INDEXER MOTOR FWD</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M13"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>INDEXER MOTOR REV</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M14"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>ARM MOTOR FWD</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M15"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>ARM MOTOR REV</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M16"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>PLUNGER ASSELY PRESS - 1</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M17"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>PLUNGER ASSELY PRESS - 2 UP</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M20"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>PLUNGER ASSELY PRESS - 2 DOWN</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M21"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>FLAP OPEN</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M22"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>FLAP CLOSE</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M33"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td>SERVO FWD</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M448"><span class="slider"></span></label></td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td>SERVO REV</td>
                            <td><label class="toggle-switch"><input type="checkbox" id="toggle-M449"><span class="slider"></span></label></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="group bin-visibility-group">
                <h3>Bin Video Visibility</h3>
                <div id="bin-visibility-container">
                    <div id="video-display">
                        <video id="video-display-video" class="indicator-video-large" autoplay loop muted playsinline src="/static/ASSLY_IMAGES/off.mp4"></video>
                        <p id="video-display-name">None</p>
                    </div>
                </div>
                <h3>Bin images Visibility</h3>
                    <div class="bin-images-container">
                        <div id="current-bin">
                            <h4>Current Bin</h4>
                            <img id="current-bin-image" class="indicator-image-large" src="/static/ASSLY_IMAGES/off.jpeg" alt="Current Bin">
                            <p id="current-bin-name">None</p>
                        </div>
                        <div id="next-bin">
                            <h4>Next Bin</h4>
                            <img id="next-bin-image" class="indicator-image-large" src="/static/ASSLY_IMAGES/off.jpeg" alt="Next Bin">
                            <p id="next-bin-name">None</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="display:none">
            <!-- Additional indicators for new bits -->
            <span id="state-M3"></span><img class="indicator-image" id="indicator-M3" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M13"></span><img class="indicator-image" id="indicator-M13" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M14"></span><img class="indicator-image" id="indicator-M14" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M15"></span><img class="indicator-image" id="indicator-M15" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M16"></span><img class="indicator-image" id="indicator-M16" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M17"></span><img class="indicator-image" id="indicator-M17" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M20"></span><img class="indicator-image" id="indicator-M20" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M21"></span><img class="indicator-image" id="indicator-M21" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M22"></span><img class="indicator-image" id="indicator-M22" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M23"></span><img class="indicator-image" id="indicator-M23" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M448"></span><img class="indicator-image" id="indicator-M448" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M449"></span><img class="indicator-image" id="indicator-M449" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <!-- M200 to M248 -->
            <span id="state-M200"></span><img class="indicator-image" id="indicator-M200" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M201"></span><img class="indicator-image" id="indicator-M201" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M202"></span><img class="indicator-image" id="indicator-M202" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M203"></span><img class="indicator-image" id="indicator-M203" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M204"></span><img class="indicator-image" id="indicator-M204" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M205"></span><img class="indicator-image" id="indicator-M205" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M206"></span><img class="indicator-image" id="indicator-M206" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M207"></span><img class="indicator-image" id="indicator-M207" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M208"></span><img class="indicator-image" id="indicator-M208" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M209"></span><img class="indicator-image" id="indicator-M209" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M210"></span><img class="indicator-image" id="indicator-M210" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M211"></span><img class="indicator-image" id="indicator-M211" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M212"></span><img class="indicator-image" id="indicator-M212" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M213"></span><img class="indicator-image" id="indicator-M213" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M214"></span><img class="indicator-image" id="indicator-M214" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M215"></span><img class="indicator-image" id="indicator-M215" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M216"></span><img class="indicator-image" id="indicator-M216" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M217"></span><img class="indicator-image" id="indicator-M217" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M218"></span><img class="indicator-image" id="indicator-M218" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M219"></span><img class="indicator-image" id="indicator-M219" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M220"></span><img class="indicator-image" id="indicator-M220" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M221"></span><img class="indicator-image" id="indicator-M221" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M222"></span><img class="indicator-image" id="indicator-M222" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M223"></span><img class="indicator-image" id="indicator-M223" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M224"></span><img class="indicator-image" id="indicator-M224" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M225"></span><img class="indicator-image" id="indicator-M225" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M226"></span><img class="indicator-image" id="indicator-M226" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M227"></span><img class="indicator-image" id="indicator-M227" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M228"></span><img class="indicator-image" id="indicator-M228" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M229"></span><img class="indicator-image" id="indicator-M229" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M230"></span><img class="indicator-image" id="indicator-M230" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M231"></span><img class="indicator-image" id="indicator-M231" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M232"></span><img class="indicator-image" id="indicator-M232" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M233"></span><img class="indicator-image" id="indicator-M233" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M234"></span><img class="indicator-image" id="indicator-M234" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M235"></span><img class="indicator-image" id="indicator-M235" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M236"></span><img class="indicator-image" id="indicator-M236" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M237"></span><img class="indicator-image" id="indicator-M237" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M238"></span><img class="indicator-image" id="indicator-M238" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M239"></span><img class="indicator-image" id="indicator-M239" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M240"></span><img class="indicator-image" id="indicator-M240" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M241"></span><img class="indicator-image" id="indicator-M241" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M242"></span><img class="indicator-image" id="indicator-M242" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M243"></span><img class="indicator-image" id="indicator-M243" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M244"></span><img class="indicator-image" id="indicator-M244" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M245"></span><img class="indicator-image" id="indicator-M245" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M246"></span><img class="indicator-image" id="indicator-M246" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M247"></span><img class="indicator-image" id="indicator-M247" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
            <span id="state-M248"></span><img class="indicator-image" id="indicator-M248" src="/static/ASSLY_IMAGES/off.png" alt="Indicator">
        </div>
    </div>

    <div id="set-quantity" class="page">
        <div class="group vfd-table">
            <h3>VFD & Motor Parameter Settings</h3>
            <table>
                <thead>
                    <tr>
                        <th>VFD WRITE</th>
                        <th>SERVO TRQ</th>
                        <th>SERVO SPEED</th>
                        <th>PLUNGER HOLD TIME</th>
                        <th>SERVO FWD TIME</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span id="D500">0</span>
                        <input type="number" id="D500_input" min="0" max="50" step="1" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D500',v)"></td>
                        <td><span id="D802">0</span>
                        <input type="number" id="D802_input" min="0" max="70" step="1" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D802',v)"></td>
                        <td><span id="D812">0</span>
                        <input type="number" id="D812_input" min="0" max="10" step="1" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D812',v)"></td>
                        <td><span id="D304">0</span>
                        <input type="number" id="D304_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D304',v)"></td>
                        <td><span id="D306">0</span>
                        <input type="number" id="D306_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D306',v)"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="table-container">
            <div class="column">
                <div class="group">
                    <h3>Plunger Assembly</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>BIN NO</th>
                                <th>Name</th>
                                <th>Recipe (W)</th>
                                <th>Act Qty (R)</th>
                                <th>Set Qty (W)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>PLUNGER HSG ARM BT 40</td>
                                <td><span id="D310">0</span> <input type="number" id="D310_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D310',v)"></td>
                                <td><span id="D410">0</span></td>
                                <td><span id="D610">0</span> <input type="number" id="D610_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D610',v)"></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>OIL SEAL OS15X21X3 IKO MAKE</td>
                                <td><span id="D312">0</span> <input type="number" id="D312_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D312',v)"></td>
                                <td><span id="D412">0</span></td>
                                <td><span id="D612">0</span> <input type="number" id="D612_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D612',v)"></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>PLUNGER ARM BT40</td>
                                <td><span id="D314">0</span> <input type="number" id="D314_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D314',v)"></td>
                                <td><span id="D414">0</span></td>
                                <td><span id="D614">0</span> <input type="number" id="D614_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D614',v)"></td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>PARALLEL KEY 4X4X12</td>
                                <td><span id="D316">0</span> <input type="number" id="D316_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D316',v)"></td>
                                <td><span id="D416">0</span></td>
                                <td><span id="D616">0</span> <input type="number" id="D616_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D616',v)"></td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>SPRING PLUNGER BT 40 ARM</td>
                                <td><span id="D318">0</span> <input type="number" id="D318_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D318',v)"></td>
                                <td><span id="D418">0</span></td>
                                <td><span id="D618">0</span> <input type="number" id="D618_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D618',v)"></td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>PLUNGERNUT ARM BT 40</td>
                                <td><span id="D320">0</span> <input type="number" id="D320_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D320',v)"></td>
                                <td><span id="D420">0</span></td>
                                <td><span id="D620">0</span> <input type="number" id="D620_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D620',v)"></td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>O RING 23X15</td>
                                <td><span id="D322">0</span> <input type="number" id="D322_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D322',v)"></td>
                                <td><span id="D422">0</span></td>
                                <td><span id="D622">0</span> <input type="number" id="D622_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D622',v)"></td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>O RING 28X2</td>
                                <td><span id="D324">0</span> <input type="number" id="D324_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D324',v)"></td>
                                <td><span id="D424">0</span></td>
                                <td><span id="D624">0</span> <input type="number" id="D624_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D624',v)"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="group">
                    <h3>Ring Feeder Assembly</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>BIN NO</th>
                                <th>Name</th>
                                <th>Recipe (W)</th>
                                <th>Act Qty (R)</th>
                                <th>Set Qty (W)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>RING FEEDER HSG BT40</td>
                                <td><span id="D326">0</span> <input type="number" id="D326_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D326',v)"></td>
                                <td><span id="D426">0</span></td>
                                <td><span id="D626">0</span> <input type="number" id="D626_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D626',v)"></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>RING FEEDER SPACER ATC</td>
                                <td><span id="D328">0</span> <input type="number" id="D328_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D328',v)"></td>
                                <td><span id="D428">0</span></td>
                                <td><span id="D628">0</span> <input type="number" id="D628_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D628',v)"></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>BTP80 LOCKING ELEMENT 35X40</td>
                                <td><span id="D330">0</span> <input type="number" id="D330_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D330',v)"></td>
                                <td><span id="D430">0</span></td>
                                <td><span id="D630">0</span> <input type="number" id="D630_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D630',v)"></td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>RING FEEDER CLAMP BT40</td>
                                <td><span id="D332">0</span> <input type="number" id="D332_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D332',v)"></td>
                                <td><span id="D432">0</span></td>
                                <td><span id="D632">0</span> <input type="number" id="D632_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D632',v)"></td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>SOC HD SCREW 6X25</td>
                                <td><span id="D334">0</span> <input type="number" id="D334_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D334',v)"></td>
                                <td><span id="D434">0</span></td>
                                <td><span id="D634">0</span> <input type="number" id="D634_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D634',v)"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="column">
                <div class="group">
                    <h3>Arm Assembly</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>BIN NO</th>
                                <th>Name</th>
                                <th>Recipe (W)</th>
                                <th>Act Qty (R)</th>
                                <th>Set Qty (W)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>ARM BODY</td>
                                <td><span id="D336">0</span> <input type="number" id="D336_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D336',v)"></td>
                                <td><span id="D436">0</span></td>
                                <td><span id="D636">0</span> <input type="number" id="D636_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D636',v)"></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>LFB 1820 DU BUSH 18XOD 20XL 20</td>
                                <td><span id="D338">0</span> <input type="number" id="D338_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D338',v)"></td>
                                <td><span id="D438">0</span></td>
                                <td><span id="D638">0</span> <input type="number" id="D638_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D638',v)"></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>LFB 1215 DU BUSH 12XOD 14XL 15</td>
                                <td><span id="D340">0</span> <input type="number" id="D340_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D340',v)"></td>
                                <td><span id="D440">0</span></td>
                                <td><span id="D640">0</span> <input type="number" id="D640_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D640',v)"></td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>OIL SEAL OS18X26X4 IKO MAKE</td>
                                <td><span id="D342">0</span> <input type="number" id="D342_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D342',v)"></td>
                                <td><span id="D442">0</span></td>
                                <td><span id="D642">0</span> <input type="number" id="D642_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D642',v)"></td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>SOC HD SCREW 6X30</td>
                                <td><span id="D348">0</span> <input type="number" id="D348_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D348',v)"></td>
                                <td><span id="D444">0</span></td>
                                <td><span id="D644">0</span> <input type="number" id="D644_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D644',v)"></td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>PUSHROD</td>
                                <td><span id="D350">0</span> <input type="number" id="D350_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D350',v)"></td>
                                <td><span id="D446">0</span></td>
                                <td><span id="D646">0</span> <input type="number" id="D646_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D646',v)"></td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>SPRING PUSHROAD BT40</td>
                                <td><span id="D352">0</span> <input type="number" id="D352_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D352',v)"></td>
                                <td><span id="D448">0</span></td>
                                <td><span id="D648">0</span> <input type="number" id="D648_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D648',v)"></td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>ANTIROTATION KEY</td>
                                <td><span id="D354">0</span> <input type="number" id="D354_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D354',v)"></td>
                                <td><span id="D450">0</span></td>
                                <td><span id="D650">0</span> <input type="number" id="D650_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D650',v)"></td>
                            </tr>
                            <tr>
                                <td>9</td>
                                <td>ORING 12X2</td>
                                <td><span id="D356">0</span> <input type="number" id="D356_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D356',v)"></td>
                                <td><span id="D452">0</span></td>
                                <td><span id="D652">0</span> <input type="number" id="D652_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D652',v)"></td>
                            </tr>
                            <tr>
                                <td>10</td>
                                <td>SOC HD SCREW 5X10</td>
                                <td><span id="D358">0</span> <input type="number" id="D358_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D358',v)"></td>
                                <td><span id="D454">0</span></td>
                                <td><span id="D654">0</span> <input type="number" id="D654_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D654',v)"></td>
                            </tr>
                            <tr>
                                <td>11</td>
                                <td>GRIPPER PLT BT40 16MNCR5</td>
                                <td><span id="D360">0</span> <input type="number" id="D360_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D360',v)"></td>
                                <td><span id="D456">0</span></td>
                                <td><span id="D656">0</span> <input type="number" id="D656_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D656',v)"></td>
                            </tr>
                            <tr>
                                <td>12</td>
                                <td>SOC HD SCREW 8X20</td>
                                <td><span id="D362">0</span> <input type="number" id="D362_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D362',v)"></td>
                                <td><span id="D458">0</span></td>
                                <td><span id="D658">0</span> <input type="number" id="D658_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D658',v)"></td>
                            </tr>
                            <tr>
                                <td>13</td>
                                <td>ITCP PIN 8X25</td>
                                <td><span id="D364">0</span> <input type="number" id="D364_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D364',v)"></td>
                                <td><span id="D460">0</span></td>
                                <td><span id="D660">0</span> <input type="number" id="D660_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D660',v)"></td>
                            </tr>
                            <tr>
                                <td>14</td>
                                <td>ARM KEY SK40</td>
                                <td><span id="D366">0</span> <input type="number" id="D366_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D366',v)"></td>
                                <td><span id="D462">0</span></td>
                                <td><span id="D662">0</span> <input type="number" id="D662_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D662',v)"></td>
                            </tr>
                            <tr>
                                <td>15</td>
                                <td>CSK SCREW 6X10</td>
                                <td><span id="D368">0</span> <input type="number" id="D368_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D368',v)"></td>
                                <td><span id="D464">0</span></td>
                                <td><span id="D664">0</span> <input type="number" id="D664_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D664',v)"></td>
                            </tr>
                            <tr>
                                <td>16</td>
                                <td>SPARE RING FEEDER HSG ASSY 40SERIES</td>
                                <td><span id="D344">0</span> <input type="number" id="D344_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D344',v)"></td>
                                <td><span id="D466">0</span></td>
                                <td><span id="D666">0</span> <input type="number" id="D666_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D666',v)"></td>
                            </tr>
                            <tr>
                                <td>17</td>
                                <td>SPARE PLUNGER HSG ASSY 40 SERIES</td>
                                <td><span id="D346">0</span> <input type="number" id="D346_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D346',v)"></td>
                                <td><span id="D468">0</span></td>
                                <td><span id="D668">0</span> <input type="number" id="D668_input" min="0" max="99999" onchange="let v=parseInt(this.value);let mn=parseInt(this.min);let mx=parseInt(this.max);if(!isNaN(v)&&v>=mn&&v<=mx)writeWord('D668',v)"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-actions">
            <div class="footer-action">
                <span>🔩 PLUNGER SELECT</span>
                <label class="toggle-switch"><input type="checkbox" id="footer-toggle-L100"><span class="slider"></span></label>
            </div>
            <div class="footer-action">
                <span>⭕ RING FEEDER SELECT</span>
                <label class="toggle-switch"><input type="checkbox" id="footer-toggle-L101"><span class="slider"></span></label>
            </div>
            <div class="footer-action">
                <span>🦾 ARM SELECT</span>
                <label class="toggle-switch"><input type="checkbox" id="footer-toggle-L102"><span class="slider"></span></label>
            </div>
        </div>
    </footer>

    <script>
        /******************************
        * 🌐 GLOBAL SOCKET CONNECTION (single instance)
        ******************************/
        const socket = io({ autoConnect: true, reconnection: true });
        console.log('✅ SocketIO connected (global instance)');

        /******************************
        * 🚨 ALARM DEFINITIONS
        ******************************/
        const alarmTags = [
            { tag: 'M200', name: 'MAIN EMG STOP' },
            { tag: 'M201', name: 'PLUNGER ASSLY EMG STOP' },
            { tag: 'M202', name: 'RING FEEDER ASSLY EMG STOP' },
            { tag: 'M203', name: 'ARM ASSLY EMG STOP' },
            { tag: 'M204', name: 'INDEXER MOTOR TRIP' },
            { tag: 'M205', name: 'ARM MPCB TRIP' },
            { tag: 'M206', name: 'SERVO MOTOR TRIP' },
            { tag: 'M207', name: 'PLUNGER ASSLY CYL FWD RD' },
            { tag: 'M208', name: 'PLUNGER ASSLY CYL REV RD' },
            { tag: 'M209', name: 'CYL UP RING FEEDER ASSLY FWD RD' },
            { tag: 'M210', name: 'CYL UP RING FEEDER ASSLY REV RD' },
            { tag: 'M211', name: 'CYL DOWN RING FEEDER ASSLY FWD RD' },
            { tag: 'M212', name: 'CYL DOWN RING FEEDER ASSLY REV RD' },
            { tag: 'M213', name: 'FLP CYL CLOSE FWD RD' },
            { tag: 'M214', name: 'FLP CYL OPEN REV RD' },
            { tag: 'M215', name: 'CYL5 FWD RD' },
            { tag: 'M216', name: 'CYL5 REV RD' },
            { tag: 'M217', name: 'CYL6 FWD RD' },
            { tag: 'M218', name: 'CYL6 REV RD' },
            { tag: 'M219', name: 'PLUNGER HSG ARM BT40 EMPTY' },
            { tag: 'M220', name: 'OIL SEAL OS15X21X3 IKO MAKE EMPTY' },
            { tag: 'M221', name: 'PLUNGER ARM BT40 EMPTY' },
            { tag: 'M222', name: 'PARALLEL KEY 4X4X12 EMPTY' },
            { tag: 'M223', name: 'SPRING PLUNGER BT40 ARM EMPTY' },
            { tag: 'M224', name: 'PLUNGERNUT ARM BT 40 EMPTY' },
            { tag: 'M225', name: 'O RING 23X1 5 EMPTY' },
            { tag: 'M226', name: 'O RING 28X2 EMPTY' },
            { tag: 'M227', name: 'RING FEEDER HSG BT40 EMPTY' },
            { tag: 'M228', name: 'RING FEDER SPACER EMPTY' },
            { tag: 'M229', name: 'BTP 80 LOCKING ELEMENT 35X40 EMPTY' },
            { tag: 'M230', name: 'RING FEEDER CLAMP BT40 EMPTY' },
            { tag: 'M231', name: 'SOC HD SCREW 6X25 EMPTY' },
            { tag: 'M232', name: 'ARM BODY 225 EMPTY' },
            { tag: 'M233', name: 'LFB 1820 DU BUSH 18XOD 20XL 20 EMPTY' },
            { tag: 'M234', name: 'LFB 1215 DU BUSH 12XOD 14XL 15 EMPTY' },
            { tag: 'M235', name: 'OIL SEAL OS18X26X4 IKO MAKE EMPTY' },
            { tag: 'M236', name: 'RING FEEDER HSG ASSY 40SERIES EMPTY' },
            { tag: 'M237', name: 'PLUNGER HSG ASSY 40SERIES EMPTY' },
            { tag: 'M238', name: 'SOC HD SCREW 6X30 BIN 18 EMPTY' },
            { tag: 'M239', name: 'PUSHROD 225 BIN 19 EMPTY' },
            { tag: 'M240', name: 'SPRING PUSHROD BT40 EMPTY' },
            { tag: 'M241', name: 'ANTI ROTATION KEY EMPTY' },
            { tag: 'M242', name: 'O RING 12X2 EMPTY' },
            { tag: 'M243', name: 'SOC HD SCREW 5X10 EMPTY' },
            { tag: 'M244', name: 'GRIPPER PLT BT40 16 MNCR5 EMPTY' },
            { tag: 'M245', name: 'SOC HD SCREW 8X20 EMPTY' },
            { tag: 'M246', name: 'ITCP PIN 8X25 EMPTY' },
            { tag: 'M247', name: 'ARM KEY SK40 EMPTY' },
            { tag: 'M248', name: 'CSK SCREW 6X10 EMPTY' },
            { tag: 'M249', name: 'PLEASE SELECT AUTO MODE' },
            { tag: 'M250', name: 'RECIPE NOT SELECTED' }
        ];

        /******************************
        * 🖼 IMAGE & VIDEO MAPS
        ******************************/
        const imageMap = {
            '1': { image: '/static/ASSLY_IMAGES/1.jpeg', name: 'PLUNGER HSG ARM BT 40' },
            '2': { image: '/static/ASSLY_IMAGES/2.jpeg', name: 'OIL SEAL OS15X21X3 IKO MAKE' },
            '3': { image: '/static/ASSLY_IMAGES/3.jpeg', name: 'PLUNGER ARM BT40' },
            '4': { image: '/static/ASSLY_IMAGES/4.jpeg', name: 'PARALLE KEY 4X4X12' },
            '5': { image: '/static/ASSLY_IMAGES/5.jpeg', name: 'SPRING PLUNGER BT 40 ARM' },
            '6': { image: '/static/ASSLY_IMAGES/6.jpeg', name: 'PLUNGERNUT ARM BT 40' },
            '7': { image: '/static/ASSLY_IMAGES/7.jpeg', name: 'O RING 23X15' },
            '8': { image: '/static/ASSLY_IMAGES/8.jpeg', name: 'O RING 28X2' },
            '9': { image: '/static/ASSLY_IMAGES/9.jpeg', name: 'RING FEEDER HSG BT40' },
            '10': { image: '/static/ASSLY_IMAGES/10.jpeg', name: 'RING FEEDER SPACER ATC' },
            '11': { image: '/static/ASSLY_IMAGES/11.jpeg', name: 'BTP80 LOCKING ELEMENT 35X40' },
            '12': { image: '/static/ASSLY_IMAGES/12.jpeg', name: 'RING FEEDER CLAMP BT40' },
            '13': { image: '/static/ASSLY_IMAGES/13.jpeg', name: 'SOC HD SCREW 6X25' },
            '14': { image: '/static/ASSLY_IMAGES/14.jpeg', name: 'ARM BODY 225' },
            '15': { image: '/static/ASSLY_IMAGES/15.jpeg', name: 'LFB 1820 DU BUSH 18XOD 20XL 20' },
            '16': { image: '/static/ASSLY_IMAGES/16.jpeg', name: 'LFB 1215 DU BUSH 12XOD 14XL 15' },
            'default': { image: '/static/ASSLY_IMAGES/off.jpeg', name: 'None' }
        };

        const videoMap = {
            '1': { video: '/static/ASSLY_IMAGES/1. Ring feeder assly.mp4', name: 'Ring Feeder Assembly' },
            '2': { video: '/static/ASSLY_IMAGES/2. plunger assly.mp4', name: 'Plunger Assembly' },
            '3': { video: '/static/ASSLY_IMAGES/3. Arm assly.mp4', name: 'Arm Assembly' },
            'default': { video: '/static/ASSLY_IMAGES/off.mp4', name: 'None' }
        };

        /******************************
        * 🧠 STATE CACHES
        ******************************/
        let lastD550 = null;
        let lastD552 = null;
        let lastD554 = null;

        /******************************
        * 🔗 SOCKET EVENT HANDLERS
        ******************************/
        socket.on('connect', () => console.log('✅ Connected to server'));
        socket.on('disconnect', () => console.warn('❌ Disconnected from server'));

        socket.on('plc_data', (data) => {
            if (data?.error) return console.error('PLC Data Error:', data.error);

            let hasActiveAlarms = false;

            const videoValue = data.words['D550'] || 0;
            const currentBinValue = data.words['D552'] || 0;
            const nextBinValue = data.words['D554'] || 0;

            // Update video
            if (videoValue !== lastD550) {
                const vd = videoMap[videoValue] || videoMap['default'];
                const vEl = document.getElementById('video-display-video');
                const vName = document.getElementById('video-display-name');
                if (vEl && vEl.src !== window.location.origin + vd.video) {
                    vEl.src = vd.video;
                    vEl.load();
                    vEl.play().catch(console.warn);
                }
                if (vName) vName.textContent = vd.name;
                lastD550 = videoValue;
            }

            // Update current bin
            if (currentBinValue !== lastD552) {
                const cb = imageMap[currentBinValue] || imageMap['default'];
                document.getElementById('current-bin-image').src = cb.image;
                document.getElementById('current-bin-name').textContent = cb.name;
                lastD552 = currentBinValue;
            }

            // Update next bin
            if (nextBinValue !== lastD554) {
                const nb = imageMap[nextBinValue] || imageMap['default'];
                document.getElementById('next-bin-image').src = nb.image;
                document.getElementById('next-bin-name').textContent = nb.name;
                lastD554 = nextBinValue;
            }

            // Update bits & alarms
            for (let tag in data.bits) {
                const bitVal = data.bits[tag];
                const ind = document.getElementById(`indicator-${tag}`);
                if (ind) ind.className = `indicator ${bitVal ? 'on' : 'off'}`;
                if (alarmTags.some(a => a.tag === tag && bitVal)) hasActiveAlarms = true;
            }

            const alarmBtn = document.getElementById('alarm-button');
            alarmBtn.classList.toggle('alarm-active', hasActiveAlarms);
            alarmBtn.textContent = hasActiveAlarms ? 'ALARMS ⚠️' : 'ALARMS';

            // Update words
            for (let tag in data.words) {
                const el = document.getElementById(tag);
                if (el) el.textContent = data.words[tag];
            }

            // Sync dropdown
            const sel556 = document.getElementById('D556_select');
            if (sel556 && data.words['D556'] !== undefined) sel556.value = data.words['D556'];
        });

        /******************************
        * ✅ SINGLE WRITE FUNCTION
        ******************************/
        function writeWord(tag, inputIdOrValue) {
            let value;

            if (typeof inputIdOrValue === 'string') {
                const el = document.getElementById(inputIdOrValue);
                if (el) {
                    const raw = el.value.trim();
                    if (raw === '') return;
                    value = parseInt(raw, 10);
                } else {
                    value = parseInt(inputIdOrValue, 10);
                }
            } else {
                value = parseInt(inputIdOrValue, 10);
            }

            if (!isNaN(value)) {
                socket.emit('write_word', { tag, value });
                console.log(`✍️ Write ${tag} = ${value}`);
            } else {
                console.warn(`⚠️ Invalid write to ${tag}`);
            }
        }

        /******************************
        * ⚙️ DEBOUNCE & BIT CONTROL
        ******************************/
        function debounce(fn, delay) {
            let t;
            return (...a) => {
                clearTimeout(t);
                t = setTimeout(() => fn(...a), delay);
            };
        }

        const setBitDebounced = debounce((tag, value) => {
            socket.emit('set_bit', { tag, value });
            console.log(`Set bit ${tag} = ${value}`);
        }, 80);

        function setBit(tag, value) {
            setBitDebounced(tag, value);
        }

        /******************************
        * 📱 SUCCESS MESSAGE
        ******************************/
        function showSuccess() {
            const msg = document.getElementById('success-msg');
            msg.style.display = 'block';
            setTimeout(() => {
                msg.style.display = 'none';
            }, 3000);
        }

        /******************************
        * 🧭 PAGE NAVIGATION
        ******************************/
        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            document.querySelector(`.nav-button[onclick="showPage('${id}')"]`).classList.add('active');
        }

        function toggleAlarmPopup() {
            const popup = document.getElementById('alarm-popup');
            popup.style.display = popup.style.display === 'flex' ? 'none' : 'flex';
        }

        /******************************
        * 🔄 RESET COUNTS LONG PRESS
        ******************************/
        const resetBtn = document.getElementById('reset-counts-btn');
        let timer;
        if (resetBtn) {
            resetBtn.addEventListener('mousedown', () => {
                resetBtn.classList.add('reset-counts-pressing');
                timer = setTimeout(() => {
                    setBit('M60', true);
                    resetBtn.textContent = '🔄 RESET COUNTS (TRIGGERED)';
                    setTimeout(() => resetBtn.textContent = '🔄 RESET COUNTS', 2000);
                }, 3000);
            });
            resetBtn.addEventListener('mouseup', () => {
                clearTimeout(timer);
                resetBtn.classList.remove('reset-counts-pressing');
            });
            resetBtn.addEventListener('mouseleave', () => {
                clearTimeout(timer);
                resetBtn.classList.remove('reset-counts-pressing');
            });
        }

        /******************************
        * ✅ INIT
        ******************************/
        showPage('home');
    </script>
</body>
</html>